SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=63
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=63
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=63]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=63, new payload ID=64
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=64
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 64 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 64, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=64
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=64
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=64]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=64, new payload ID=65
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=65
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 65 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 65, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=65
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=65
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=65]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=65, new payload ID=66
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=66
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 66 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 66, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=66
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=66
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=66]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=66, new payload ID=67
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=67
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 67 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 67, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=67]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=67, new payload ID=68
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=68
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 68 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 68, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=68]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=68, new payload ID=69
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=69
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 69 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 69, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=69]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=69, new payload ID=70
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=70
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 70 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 70, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=70
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=70
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=70]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=70, new payload ID=71
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=71
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 71 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 71, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=71]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=71, new payload ID=72
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=72
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 72 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 72, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=72]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=72, new payload ID=73
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=73
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 73 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 73, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=73]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=73, new payload ID=74
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=74
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 74 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 74, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=74
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=74
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=74]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=74, new payload ID=75
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=75
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 75 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 75, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=75]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=75, new payload ID=76
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=76
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 76 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 76, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=76]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=76, new payload ID=77
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=77
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 77 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 77, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=77]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=77, new payload ID=78
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=78
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 78 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 78, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=78]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=78, new payload ID=79
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=79
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 79 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 79, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=79]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=79, new payload ID=80
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=80
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 80 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 80, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=80]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=80, new payload ID=81
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=81
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 81 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 81, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=81]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=81, new payload ID=82
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=82
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 82 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 82, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=82
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=82
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=82]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=82, new payload ID=83
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=83
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 83 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 83, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=83]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=83, new payload ID=84
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=84
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 84 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 84, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=84]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=84, new payload ID=85
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=85
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 85 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 85, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=85
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=85
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=85]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=85, new payload ID=86
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=86
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 86 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 86, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=86]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=86, new payload ID=87
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=87
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 87 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 87, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=87]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=87, new payload ID=88
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=88
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 88 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 88, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=88
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=88
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=88]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=88, new payload ID=89
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=89
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 89 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 89, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=89]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=89, new payload ID=90
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=90
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 90 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 90, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=90]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=90, new payload ID=91
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=91
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 91 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 91, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=91
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=91
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=91]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=91, new payload ID=92
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=92
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 92 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 92, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=92]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=92, new payload ID=93
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=93
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 93 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 93, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=93
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=93
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=93]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=93, new payload ID=94
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=94
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 94 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 94, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=94]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=94, new payload ID=95
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=95
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 95 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 95, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=95
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=95
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=95]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=95, new payload ID=96
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=96
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 96 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 96, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=96]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=96, new payload ID=97
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=97
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 97 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 97, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Information: 0 : SQL message bus initializing, TableCount=1
SignalR.SqlMessageBus Information: 0 : Start installing SignalR SQL objects
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT SERVERPROPERTY ( 'EngineEdition' ), Parameters=
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText= -- Copyright (c) .NET Foundation. All rights reserved.
 -- Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

DECLARE @SCHEMA_NAME nvarchar(32),
		@SCHEMA_TABLE_NAME nvarchar(100),
		@TARGET_SCHEMA_VERSION int,
		@MESSAGE_TABLE_NAME nvarchar(100),
		@MESSAGE_TABLE_COUNT int,
        @CREATE_MESSAGE_TABLE_DDL nvarchar(1000),
		@CREATE_MESSAGE_ID_TABLE_DDL nvarchar(1000);

SET @SCHEMA_NAME = 'SignalR';
SET @SCHEMA_TABLE_NAME = 'Schema';
SET @TARGET_SCHEMA_VERSION = 1;
SET @MESSAGE_TABLE_COUNT = 1;
SET @MESSAGE_TABLE_NAME = 'Messages';
SET @CREATE_MESSAGE_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName](
    [PayloadId] [bigint] NOT NULL,
	[Payload] [varbinary](max) NOT NULL,
	[InsertedOn] [datetime] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);'
SET @CREATE_MESSAGE_ID_TABLE_DDL =
N'CREATE TABLE [' + @SCHEMA_NAME + N'].[@TableName] (
    [PayloadId] [bigint] NOT NULL,
	PRIMARY KEY CLUSTERED ([PayloadId] ASC)
);
-- Initialize PayloadId row with value 0
INSERT INTO [' + @SCHEMA_NAME + N'].[@TableName] (PayloadId) VALUES (0);';

PRINT 'Installing SignalR SQL objects';

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRANSACTION;

-- Create the DB schema if it doesn't exist
IF NOT EXISTS(SELECT [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME)
	BEGIN
		BEGIN TRY
			EXEC(N'CREATE SCHEMA [' + @SCHEMA_NAME + '];');
			PRINT 'Created database schema [' + @SCHEMA_NAME  + ']';
		END TRY
		BEGIN CATCH
            DECLARE @ErrorNumber int,
                    @ErrorSeverity int,
                    @ErrorState int;

            SELECT @ErrorNumber = ERROR_NUMBER(),
                   @ErrorSeverity = ERROR_SEVERITY(),
                   @ErrorState = ERROR_STATE();

			IF @ErrorNumber = 2759
				-- If it's an object already exists error then ignore
				PRINT 'Database schema [' + @SCHEMA_NAME + '] already exists'
			ELSE
				RAISERROR (@ErrorNumber, @ErrorSeverity, @ErrorState);
		END CATCH;
	END
ELSE
	PRINT 'Database schema [' + @SCHEMA_NAME  + '] already exists';

DECLARE @SCHEMA_ID int;
SELECT @SCHEMA_ID = [schema_id] FROM [sys].[schemas] WHERE [name] = @SCHEMA_NAME;

-- Create the SignalR_Schema table if it doesn't exist
IF NOT EXISTS(SELECT [object_id] FROM [sys].[tables] WHERE [name] = @SCHEMA_TABLE_NAME AND [schema_id] = @SCHEMA_ID)
	BEGIN
		-- Create the empty SignalR schema table
		EXEC(N'CREATE TABLE [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']('+
			 N'[SchemaVersion] [int] NOT NULL,'+
			 N'PRIMARY KEY CLUSTERED ([SchemaVersion] ASC)'+
		     N')');
		PRINT 'Created table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + ']';
	END
ELSE
	PRINT 'Table [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] already exists';

DECLARE @GET_SCHEMA_VERSION_SQL nvarchar(1000);
SET @GET_SCHEMA_VERSION_SQL = N'SELECT @schemaVersion = [SchemaVersion] FROM [' + @SCHEMA_NAME  + N'].[' + @SCHEMA_TABLE_NAME + N']';

DECLARE @CURRENT_SCHEMA_VERSION int;
EXEC sp_executesql @GET_SCHEMA_VERSION_SQL, N'@schemaVersion int output',
	@schemaVersion = @CURRENT_SCHEMA_VERSION output;

PRINT 'Current SignalR schema version: ' + CASE @CURRENT_SCHEMA_VERSION WHEN NULL THEN 'none' ELSE CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) END;

-- Install tables, etc.
IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION <= @TARGET_SCHEMA_VERSION
	BEGIN
		IF @CURRENT_SCHEMA_VERSION IS NULL OR @CURRENT_SCHEMA_VERSION = @TARGET_SCHEMA_VERSION
			BEGIN
				-- Install version 1
				PRINT 'Installing schema version 1';
				
                DECLARE @counter int;
				SET @counter = 0;
				WHILE @counter < @MESSAGE_TABLE_COUNT
					BEGIN
						DECLARE @table_name nvarchar(100);
						DECLARE @ddl nvarchar(max);
						
						-- Create the message table
						SET @table_name = @MESSAGE_TABLE_NAME + '_' + CONVERT(nvarchar, @counter);
						SET @ddl = REPLACE(@CREATE_MESSAGE_TABLE_DDL, '@TableName', @table_name);
						
						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
									    AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message table [' + @SCHEMA_NAME + '].[' + @table_name + ']';
							END
						ELSE
							PRINT 'Mesage table [' + @SCHEMA_NAME + '].[' + @table_name + '] already exists';

						-- Create the id table
						SET @table_name = @table_name + '_Id';
						SET @ddl = REPLACE(@CREATE_MESSAGE_ID_TABLE_DDL, '@TableName', @table_name);

						IF NOT EXISTS(SELECT [object_id]
									  FROM [sys].[tables]
									  WHERE [name] = @table_name
										AND [schema_id] = @SCHEMA_ID)
							BEGIN
								EXEC(@ddl);
								PRINT 'Created message ID table [' + @SCHEMA_NAME + '].[PayloadId]';
							END
						ELSE
							PRINT 'Message ID table [' + @SCHEMA_NAME + '].[' + @table_name + '] alread exists';

						SET @counter = @counter + 1;
					END
				
				IF @CURRENT_SCHEMA_VERSION IS NULL
					BEGIN
						DECLARE @insert_dml nvarchar(1000);
						SET @CURRENT_SCHEMA_VERSION = 1;
						SET @insert_dml = 'INSERT INTO [' + @SCHEMA_NAME  + '].[' + @SCHEMA_TABLE_NAME + '] ([SchemaVersion]) VALUES(' + CONVERT(nvarchar, @CURRENT_SCHEMA_VERSION) + ')';
						EXEC(@insert_dml);
					END
				
				PRINT 'Schema version 1 installed';
			END
		/*IF @CURRENT_SCHEMA_VERSION = 1
			BEGIN
				-- Update to version 2
				-- TODO: Add schema updates here when we go to v2
				SELECT GETDATE() -- dummy
			END*/

		COMMIT TRANSACTION;

		PRINT 'SignalR SQL objects installed';
	END

ELSE -- @CURRENT_SCHEMA_VERSION > @TARGET_SCHEMA_VERSION
	BEGIN
		-- Configured SqlMessageBus is lower version than current DB schema, just bail out
		ROLLBACK TRANSACTION;
		RAISERROR(N'SignalR database current schema version %d is newer than the configured SqlMessageBus schema version %d. Please update to the latest Microsoft.AspNet.SignalR.SqlServer NuGet package.', 11, 1,
			@CURRENT_SCHEMA_VERSION, @TARGET_SCHEMA_VERSION);
	END, Parameters=
SignalR.SqlMessageBus Information: 0 : SignalR SQL objects installed
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId] FROM [SignalR].[Messages_0_Id], Parameters=
SignalR.ScaleoutMessageBus Information: 0 : Stream(0) - Changed state from Initial to Open
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver started, initial payload id=97
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Executing receive reader, initial payload ID parameter=97
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Starting SQL notification listener
SignalR.SqlMessageBus Information: 0 : Stream 0 : SQL Service Broker is disabled, disabling query notifications
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Saving payload with 1 messages(s) to SQL server
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=97]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : SqlReceiver last payload ID=97, new payload ID=98
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Updated receive reader initial payload ID parameter=98
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Payload 98 containing 1 message(s) received
SignalR.ScaleoutMessageBus Information: 0 : OnReceived(0, 98, 1)
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : 1 records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 10ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 50ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 100ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 200ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 1500ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
SignalR.SqlMessageBus Verbose: 0 : Created DbCommand: CommandType=Text, CommandText=SELECT [PayloadId], [Payload], [InsertedOn] FROM [SignalR].[Messages_0] WHERE [PayloadId] > @PayloadId, Parameters= [Name=PayloadId, Value=98]
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : No records received
SignalR.SqlMessageBus Verbose: 0 : Stream 0 : Waiting 3000ms before checking for messages again
